# Todo example using Supabase, Vue.js & TypeScript

- Frontend:
  - Vue 3, TypeScript
  - [Supabase.js](https://supabase.io/docs/library/getting-started) for user management and realtime data syncing.
- Backend:
  - [app.supabase.io](https://app.supabase.io/): hosted Postgres database with restful API for usage with Supabase.js.


 ## 开发依赖：
    "@supabase/supabase-js": "^1.1.2"
    "vue": "^3.0.0"
    "node.js":"14.19.0"
    "npm":"6.14.16"
## Supabase details

### Postgres Row level security

This project uses very high-level Authorization using Postgres' Role Level Security.
When you start a Postgres database on Supabase, we populate it with an `auth` schema, and some helper functions.
When a user logs in, they are issued a JWT with the role `authenticated` and their UUID.
We can use these details to provide fine-grained control over what each user can and cannot do.

This is a trimmed-down schema, with the policies:

```sql
DROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;
drop function if EXISTS public.handle_new_account();
drop table if EXISTS public.posts;
drop table if EXISTS public.account;
drop table if EXISTS public.likes;



create table public.account (
  id uuid references auth.users not null CONSTRAINT users_id_pk PRIMARY KEY,
  email varchar(255)
);

create table public.posts (
  id bigint generated by default as identity primary key,
  user_id uuid references public.account(id) not null,
  task text check (char_length(task) > 3),
  is_complete boolean default false,
  inserted_at timestamp with time zone default timezone('utc'::text, now()) not null
);

create table public.likes (
  id bigint generated by default as identity primary key,
  account_id uuid not null ,
  post_id int not null ,
  inserted_at timestamp with time zone default timezone('utc'::text, now()) not null
);

create function public.handle_new_account() 
returns trigger as $$
begin
  insert into public.account (id, email)
  values (new.id, new.email)
  return new;
end;
$$ language plpgsql security definer;

-- trigger the function every time a user is created
  create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_account();
```
## Local development

```
npm install
```

### Compiles and hot-reloads for development

```
npm run serve
```

### Compiles and minifies for production

```
npm run build
```

### Lints and fixes files

```
npm run lint
```
